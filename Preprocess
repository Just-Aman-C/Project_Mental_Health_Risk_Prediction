from sklearn.preprocessing import LabelEncoder

def preprocess_data(df, target_column):

    df = df.copy()

    
    df.fillna("Unknown", inplace=True)

    encoder = LabelEncoder()

    for col in df.select_dtypes(include="object"):
        df[col] = encoder.fit_transform(df[col].astype(str))

    X = df.drop(columns=[target_column])
    y = df[target_column]

    return X, y
